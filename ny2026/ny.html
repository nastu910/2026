<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TRANG 2025 ALBUM</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Montserrat:wght@300;400&family=Playfair+Display:ital,wght@0,600;1,400&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0f172a; 
            --paper-color: #f2eadd; 
            --text-color: #2c241e; 
            --accent-color: #eebc51; 
            --secondary-color: #a98467; 
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-color);
            background: radial-gradient(ellipse at center, #1e293b 0%, #0f172a 100%);
            font-family: 'Dancing Script', cursive;
            color: var(--text-color);
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            touch-action: none; 
        }

        /* CANVAS EFFECTS */
        #snow-canvas, #fireworks-canvas {
            position: fixed;
            top: 0; left: 0;
            pointer-events: none;
            z-index: 100;
            opacity: 0.8;
            /* T·ªëi ∆∞u hi·ªáu su·∫•t canvas */
            transform: translateZ(0);
        }
        #fireworks-canvas { z-index: 2000; display: none; opacity: 1; }

        #happy-new-year-text {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2500;
            text-align: center;
            display: none;
            pointer-events: none;
        }

        #happy-new-year-text h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            color: var(--accent-color);
            text-shadow: 0 0 20px rgba(238, 188, 81, 0.8);
            opacity: 0;
            transform: scale(0.5);
            transition: all 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        #happy-new-year-text.show h1 { opacity: 1; transform: scale(1); }

        /* WELCOME SCREEN */
        #welcome-screen {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at center, #243b55 0%, #0f172a 100%);
            color: #e8e0d5;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 1s ease;
        }

        .typing-text {
            font-family: 'Dancing Script', cursive;
            font-size: 1.8rem;
            margin-bottom: 2rem;
            text-align: center;
            min-height: 1.5em;
            padding: 0 20px;
            line-height: 1.6;
        }

        .btn-start {
            padding: 12px 30px;
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
            background: transparent;
            cursor: pointer;
            letter-spacing: 2px;
            transition: all 0.3s;
            opacity: 0;
            font-family: 'Montserrat', sans-serif;
        }
        .btn-start:hover { 
            background: var(--accent-color); 
            color: var(--bg-color);
        }

        /* ZOOM CONTROLS */
        .zoom-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2500;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .zoom-btn {
            width: 45px;
            height: 45px;
            background: rgba(15, 23, 42, 0.8);
            color: var(--accent-color);
            border: 1px solid var(--accent-color);
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
            transition: 0.3s;
        }

        /* BOOK STRUCTURE */
        .book-container { 
            perspective: 2500px; 
            display: none; 
            z-index: 10;
            transform-origin: center center;
            will-change: transform;
        }

        .book {
            position: relative;
            width: 320px; /* Nh·ªè l·∫°i cho mobile m·∫∑c ƒë·ªãnh */
            height: 450px;
            transition: transform 0.5s;
            transform-style: preserve-3d;
            transform: translateX(50%); 
        }

        @media (min-width: 768px) {
            .book { width: 450px; height: 580px; }
        }

        .page {
            position: absolute;
            width: 100%; height: 100%;
            top: 0; left: 0;
            transform-origin: left;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.645, 0.045, 0.355, 1);
            cursor: pointer;
            user-select: none;
            /* Gia t·ªëc ph·∫ßn c·ª©ng */
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        .front, .back {
            position: absolute;
            width: 100%; height: 100%;
            top: 0; left: 0;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            padding: 20px;
            background: var(--paper-color);
            border: 1px solid #dcd3c7;
            display: flex;
            flex-direction: column;
            box-shadow: inset 3px 0 10px rgba(0,0,0,0.1);
            overflow: hidden;
            transform: translateZ(0); /* Force GPU */
        }

        .back { 
            transform: rotateY(180deg); 
            background: #ede6d8; 
            box-shadow: inset -3px 0 10px rgba(0,0,0,0.1);
        }

        .cover-front {
            background: #3e2723 !important;
            color: var(--accent-color);
            justify-content: center;
            align-items: center;
            text-align: center;
            border: 8px double var(--accent-color) !important;
        }

        .main-cover-img {
            width: 90%;
            max-height: 250px;
            object-fit: contain; 
            border: 3px solid var(--accent-color);
            margin-bottom: 25px;
            border-radius: 4px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
        }

        .page.flipped { transform: rotateY(-180deg); }

        /* MUSIC PLAYER */
        .music-player {
            position: fixed; bottom: 20px; left: 20px; z-index: 500;
            background: rgba(15, 23, 42, 0.85); color: white;
            padding: 8px 15px; border-radius: 30px; 
            font-size: 0.75rem; display: flex; align-items: center; gap: 10px;
            border: 1px solid rgba(238, 188, 81, 0.3);
            backdrop-filter: blur(5px);
        }
        .song-info {
            max-width: 100px; overflow: hidden; white-space: nowrap;
            text-overflow: ellipsis; color: var(--accent-color); font-weight: bold;
        }
        .music-controls { display: flex; gap: 10px; align-items: center; }
        .music-btn { background: none; border: none; color: white; cursor: pointer; font-size: 1rem; }

        /* GRID & POLAROID */
        .month-title {
            font-family: 'Dancing Script', cursive;
            font-size: 1.8rem;
            color: var(--accent-color);
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(169, 132, 103, 0.3);
            text-align: center;
        }

        .polaroid-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            grid-template-rows: 1fr 1fr;
            gap: 10px; 
            flex-grow: 1;
        }

        .polaroid {
            background: #faf9f6; 
            padding: 5px 5px 12px 5px;
            box-shadow: 2px 4px 8px rgba(0,0,0,0.1);
            transform: rotate(var(--r)) translateZ(0);
            text-align: center;
            height: 150px; 
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        @media (min-width: 768px) {
            .polaroid { height: 180px; }
            .month-title { font-size: 2.2rem; }
        }

        .polaroid img, .polaroid video { 
            width: 100%; 
            height: 110px; 
            object-fit: cover; 
            background: #eee; 
            border: 1px solid #ddd; 
        }

        @media (min-width: 768px) {
            .polaroid img, .polaroid video { height: 130px; }
        }

        .polaroid small { 
            font-size: 0.6rem; 
            font-family: 'Dancing Script', cursive; 
            color: #444; 
            padding-top: 5px;
            display: block;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .full-img {
            width: 100%; 
            height: 250px; 
            object-fit: contain; 
            background: #fdfdfd; 
            border: 5px solid white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        @media (min-width: 768px) {
            .full-img { height: 320px; }
        }

        .desc { 
            font-size: 0.9rem;
            line-height: 1.4; 
            font-style: italic; 
            color: var(--text-color); 
            opacity: 0.9; 
            margin-top: 10px; 
            text-align: center; 
        }

        .page-note {
            margin-top: 10px;
            font-size: 0.85rem;
            line-height: 1.3;
            color: #5d534a;
            font-style: italic;
            text-align: center;
            border-top: 1px dashed rgba(169, 132, 103, 0.2);
            padding-top: 8px;
        }

        /* ZOOM MODAL */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 5000;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            justify-content: center;
            align-items: center;
            cursor: zoom-out;
        }
        .modal-content {
            max-width: 95%;
            max-height: 80%;
            border: 3px solid white;
            background: white;
            transform: translateZ(0);
        }

        /* VOICE & VIDEO */
        .voice-card, .video-card {
            background: rgba(169, 132, 103, 0.1);
            border: 1px dashed var(--secondary-color);
            border-radius: 10px;
            padding: 10px;
            margin-top: 10px;
            text-align: center;
        }
        .video-container {
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid white;
            margin-top: 5px;
            background: #000;
        }
        .btn-voice {
            background: var(--secondary-color);
            color: white; border: none; padding: 8px 15px; border-radius: 20px;
            cursor: pointer; font-family: inherit; margin: 5px auto;
        }

        #note-2026 {
            width: 100%; height: 80px; margin-top: 10px; 
            background: rgba(255,255,255,0.1); border: 1px solid var(--accent-color); 
            color: white; padding: 10px; font-family: inherit; font-size: 0.9rem;
        }

        .sticker { position: absolute; bottom: 10px; right: 10px; font-size: 1.2rem; }
        .hidden { display: none !important; }
        .fade-in { opacity: 1 !important; }
    </style>
</head>
<body>
    <canvas id="snow-canvas"></canvas>
    <canvas id="fireworks-canvas"></canvas>

    <div id="happy-new-year-text"><h1>Happy New Year 2026</h1></div>

    <div class="zoom-controls">
        <button class="zoom-btn" id="zoom-in">+</button>
        <button class="zoom-btn" id="zoom-out">-</button>
        <button class="zoom-btn" id="zoom-reset">‚Ü∫</button>
    </div>

    <div id="image-modal" class="image-modal">
        <div id="modal-container" style="display: flex; justify-content: center; align-items: center; width: 100%;"></div>
    </div>

    <div class="music-player">
        <div class="music-controls">
            <button id="prev-song" class="music-btn">‚èÆ</button>
            <button id="play-pause" class="music-btn">‚ñ∂</button>
            <button id="next-song" class="music-btn">‚è≠</button>
        </div>
        <div class="song-info" id="song-title">Loading...</div>
        <audio id="bg-music"></audio>
    </div>

    <div id="welcome-screen">
        <div class="typing-text" id="typewriter"></div>
        <button class="btn-start" id="btn-start">ƒêI ƒê·∫æN ALBUM</button>
    </div>

    <div class="book-container" id="book-container">
        <div class="book" id="myBook">
            
            <div class="page" style="z-index: 60;">
                <div class="front cover-front">
                    <img src="https://i.postimg.cc/mg8CH9xR/pic0.png" alt="Cover" class="main-cover-img">
                    <h1 style="font-size: 1.5rem;">MIUZXC/TRANG 2025 ALBUM</h1>
                    <p>‚Äî C√πng xem l·∫°i m·ªôt nƒÉm qua ‚Äî</p>
                    <small style="margin-top: 20px; opacity: 0.8;">Ch·∫°m ƒë·ªÉ m·ªü album</small>
                </div>
                <div class="back">
                    <h2 class="month-title">MOMENT</h2>
                    <img src="https://i.postimg.cc/yNb8DqTQ/pic1.png" class="full-img zoomable">
                    <p class="desc">"Nh·ªØng moments v·ªÅ m·∫•y ng t√≠ch g√≥p ƒë∆∞·ª£c c·∫£ nƒÉm qua"</p>
                    <span class="sticker">‚ú®</span>
                </div>
            </div>

            <div class="page" style="z-index: 59;">
                <div class="front">
                    <h2 class="month-title">Opening Words</h2>
                    <p class="desc" style="text-align: left; font-size: 0.85rem;">Dear Trang 2025,<br><br>
                        L√∫c ƒë·∫ßu mu·ªën t·∫∑ng g√¨ ƒë√≥ cho m·∫•y ng v√†o cu·ªëi nƒÉm, xong hok bik t·∫∑ng g√¨, r·ªìi c√≥ √Ω t∆∞·ªüng l√† l√†m m·ªôt cu·ªën album v·ªÅ m·∫•y ng trong m·ªôt nƒÉm qua.<br><br>
                        Chi·∫øc album nh·ªè n√†y tui l√†m t·ªïng h·ª£p c√°c h√¨nh ·∫£nh t·ª´ social, pm v·ªÅ m·∫•y ng m·ªôt nƒÉm qua.<br><br>
                        Ph·∫ßn nh·∫°c coi nh∆∞ t√¥i ƒë√°nh c∆∞·ª£c ik, tui ch·ªçn nh·∫°c theo c·∫£m t√≠nh, mong l√† s·∫Ω t√¢m ƒë·∫ßu √Ω h·ª£p v·ªõi gu nh·∫°c c·ªßa m·∫•y ng. Tui c√≥ add th√™m 1 b√†i kh√°c v√¥, cho l√† b√†i n√†y s·∫Ω n√≥i ra m·ªôt ch√∫t t·∫•m l√≤ng c·ªßa tui d√†nh cho m·∫•y ng.<br><br>
                        ƒê√¢y l√† l·∫ßn ƒë·∫ßu ti√™n tui l√†m c√°i n√†y, n·∫øu c√≥ sai s√≥t g√¨ h√£y b·ªè qua cho tui.
                    </p>
                    <span class="sticker">‚úçÔ∏è</span>
                </div>
                <div class="back" id="jan-first-half"></div>
            </div>

        </div>
    </div>

    <script>
        // CONFIG & DATA
        let currentScale = window.innerWidth < 768 ? 0.8 : 1.0;
        const minScale = 0.3;
        const maxScale = 2.5;
        let isPinching = false;

        const albumData = {
            "January": [
                { url: "https://i.postimg.cc/3NYZ4KPp/pic1_t1.png", caption: "hihi v·ª´a win game üòä" },
                { url: "https://i.postimg.cc/WzT7F2Qq/pic2_t1.png", caption: "hentai üòí" }
            ],
            "February": [{ url: "https://i.postimg.cc/pry8wp8m/pic1_t2.png", caption: "ü•¥" }],
            "March": [
                { url: "https://i.postimg.cc/qvYkwgBQ/pic1_t3.png", caption: "„Éæ(Ôº†‚åí„Éº‚åíÔº†)„Éé" },
                { url: "https://i.postimg.cc/CxtF7dM6/pic2_t3.png", caption: "(‚óèÀá‚àÄÀá‚óè)" }
            ],
            "April": [{ url: "https://i.postimg.cc/wjJ6Wgt7/pic1_t4.png", caption: "Cute üòçü©∑" }],
            "May": [
                { url: "https://i.postimg.cc/SNbqJHTL/pic1_t5.png", caption: "Nay xinh ch·ª•p cho t·∫•m ü•∞" },
                { url: "https://i.postimg.cc/52xVmLMk/pic2_t5.png", caption: "‚ù§Ô∏è" },
                { url: "https://i.postimg.cc/x1jwmQKR/pic3_t5.png", caption: "ü©µ" },
                { url: "https://i.postimg.cc/Z5gwqzjS/pic4_t5.png", caption: "üñ§" },
            ],
            "June": [
                { url: "https://i.postimg.cc/nrSHW1fQ/pic1_t6.png", caption: "(*^‚ñΩ^*)" },
                { url: "https://i.postimg.cc/h42PhKQK/pic2_t6.png", caption: "`(*>Ôπè<*)‚Ä≤" },
                { url: "https://i.postimg.cc/zv2JQkYV/pic3_t6.png", caption: "(‚úø‚ó†‚Äø‚ó†)" },
                { url: "https://i.postimg.cc/fW8TkMSR/pic4_t6.png", caption: "(‚âß‚àá‚â¶)" },
                { url: "https://i.postimg.cc/Cx0HcCJx/pic5_t6.png", caption: "o((>œâ< ))o" },
                { url: "https://i.postimg.cc/y8KXLhnd/pic6_t6.png", caption: "( ‚Ä¢ÃÄ œâ ‚Ä¢ÃÅ )" },
                { url: "https://i.postimg.cc/y8KXLhnJ/pic7_t6.png", caption: "o((>œâ< ))o" },
                { url: "https://i.postimg.cc/4xGbWvw7/pic8_t6.png", caption: "(‚ùÅ¬¥‚ó°`‚ùÅ)" }
            ],
            "July": [
                { url: "https://i.postimg.cc/RZmQg1Gm/pic1_t7.png", caption: "( ‚Ä¢ÃÄ œâ ‚Ä¢ÃÅ )‚úß" },
                { url: "https://i.postimg.cc/y8KXLhnB/pic2_t7.png", caption: "q(‚âß‚ñΩ‚â¶q)" },
                { url: "https://i.postimg.cc/vZyL07Xb/pic3_t7.png", caption: "(^„Éªœâ„Éª^ )" },
                { url: "https://i.postimg.cc/RZmQg1GB/pic4_t7.png", caption: "(o„Çú‚ñΩ„Çú)o‚òÜ" },
                { url: "https://i.postimg.cc/htnb28MG/pic5_t7.png", caption: "‚ú™ œâ ‚ú™" },
                { url: "https://i.postimg.cc/htnb28Mv/pic6_t7.png", caption: "(‚úø‚óï‚Äø‚óï‚úø)" },
                { url: "https://i.postimg.cc/c4FwcqKF/pic7_t7.png", caption: "(. ‚ùõ ·¥ó ‚ùõ.)" },
                { url: "https://i.postimg.cc/zXxKkmLt/pic8_t7.png", caption: "(„ÄÇ„Éªœâ„Éª„ÄÇ)" }
            ],
            "August": [
                { url: "https://i.postimg.cc/Hs6XtGJ7/pic1_t8.png", caption: "Pretty" },
                { url: "https://i.postimg.cc/Nfdmxhyy/pic2_t8.png", caption: "Shining" },
                { url: "https://i.postimg.cc/Wb5g7RDF/pic3_t8.png", caption: "Lovely" },
                { url: "https://i.postimg.cc/fT8mv43X/pic4_t8.png", caption: "Sweet" },
                { url: "https://i.postimg.cc/sDT7JFBP/pic5_t8.png", caption: "Hey" },
                { url: "https://i.postimg.cc/m2mCSxcN/pic6_t8.png", caption: "Tiny" },
                { url: "https://i.postimg.cc/02VDCg6t/pic7_t8.png", caption: "üíå" },
                { url: "https://i.postimg.cc/FHjfn2zV/pic8_t8.png", caption: "Charming" }
            ],
            "September": [
                { url: "https://i.postimg.cc/2SpbGzkv/pic1_t9.png", caption: "ü§ó" },
                { url: "https://i.postimg.cc/rw60j8V1/pic2_t9.png", caption: "üòä" },
                { url: "https://i.postimg.cc/Njh9Dgs8/pic3_t9.png", caption: "‚ò∫Ô∏è" },
                { url: "https://i.postimg.cc/VkyrgYfB/pic4_t9.png", caption: "ü§©" },
                { url: "https://i.postimg.cc/RZr6dMSX/pic5_t9.png", caption: "üòó" },
                { url: "https://i.postimg.cc/Njh9Dgsz/pic6_t9.png", caption: "üòô" },
                { url: "https://i.postimg.cc/QdpBnRCq/pic7_t9.png", caption: "üòö" },
                { url: "https://i.postimg.cc/YC14yJ03/pic8_t9.png", caption: "üòò" }
            ],
            "October": [
                { url: "https://i.postimg.cc/jSLTDN0c/pic1_t10.png", caption: "Kawaii ü•∞" },
                { url: "https://i.postimg.cc/bwsPZbcT/pic2_t10.png", caption: "Adorable ‚ù§Ô∏è" },
                { url: "https://i.postimg.cc/BnX3jD9B/pic3_t10.png", caption: "Kiss kiss üíã" },
                { url: "https://i.postimg.cc/9XZBpLZ2/pic4_t10.png", caption: "Bunny üê∞" },
                { url: "https://i.postimg.cc/zDKkjxKY/pic5_t10.png", caption: "Little crazy ü§™" },
                { url: "https://i.postimg.cc/VsnFRKn8/pic6_t10.png", caption: "Precious" },
                { url: "https://i.postimg.cc/GmHR4YwV/pic7_t10.png", caption: "Th√†nh t·ª±u nh·ªè üèÜ" },
                { url: "./video/video1_t10.mp4", caption: "Chill chill get home" },
            ],
            "November": [
                { url: "./video/videot11.mp4", caption: "Cool" },
                { url: "https://i.postimg.cc/ZqvNqqxV/pic1_t11.png", caption: "(‚ù§Ô∏è œâ ‚ù§Ô∏è)" },
                { url: "https://i.postimg.cc/mr19rryX/pic2_t11.png", caption: "(‚òÖ œâ ‚òÖ)" },
                { url: "https://i.postimg.cc/rpR4ppNZ/pic3_t11.png", caption: "(^‚óï.‚óï^)" },
                { url: "https://i.postimg.cc/zv2DWCJ2/pic4_t11.png", caption: "Meow üò∏" },
                { url: "https://i.postimg.cc/5tQzttSs/pic5_t11.png", caption: "(*‚úß√ó‚úß*)" },
                { url: "./video/video1_t11.mp4", caption: "UwU" }
            ],
            "December": [
                { url: "https://i.postimg.cc/5yybxXwY/pic1_t12.png", caption: "Beautiful üíï" },
                { url: "https://i.postimg.cc/zvv8Jyn3/pic2_t12.png", caption: "Angel ü™Ω" },
                { url: "https://i.postimg.cc/T11fRKrK/pic3_t12.png", caption: "Gorgeous ‚ú®" },
                { url: "https://i.postimg.cc/NFFBgK15/pic4_t12.png", caption: "Stunning ‚ù§Ô∏è‚Äçüî•" },
                { url: "./video/video1_t12.mp4", caption: "Still cute üíñ" },
                { url: "./video/video2_t12.mp4", caption: "Hi ‚úåÔ∏è" }
            ]
        };

        const monthNotes = {
            "January": ["Nh·ªØng th√°ng ƒë·∫ßu h√¨nh v·ªÅ m·∫•y ng hok ƒëc nh√¨u.", "C√≥ th√™m t√≠nh nƒÉng ph√≥ng to ·∫£nh ƒë·ªÉ xem r√µ h∆°n n√®."],
            "February": ["T·∫•m m·∫∑t m·ªôc duy nh·∫•t, h√¥m ƒë√≥ ch·∫Øc say qu√° xong g·ª≠i cho tui xem."],
            "March": ["Album n√†y tui ch·ªçn l·ªçc m·∫•y t·∫•m d·ªãu d·ªãu nh·∫•t c√≥ th·ªÉ üòë."], 
            "April": ["Moment cute hok th·ªÉ qu√™n üôÑ."],
            "May": ["ü§ç‚ù§Ô∏èü©µüñ§"],
            "June": ["T·∫ßm gi·ªØa nƒÉm m·ªõi t·ªïng h·ª£p ƒëc nh√¨u h√¨nh h∆°n t√≠.", "Th·ª© t·ª± ·∫£nh c√≥ th·ªÉ h∆°i l·ªách th√°ng m·ªôt ch√∫t nha."],
            "July": ["L√∫c n√†y c√≥ m·∫•y tatto m·ªõi v·ª´a ƒë·∫πp v·ª´a d·∫±m khƒÉm."],
            "August": ["Vibe n√†ng th∆° ü§ç."],
            "September": ["C√≥ nh·ªØng h√¨nh hok bik ghi g√¨, n√™n ƒë·ªÉ icon nha."],
            "October": ["Update b·∫£n th√¢n & ƒê·ªÅ c·ª≠ Teen Creator of the Year 2025."],
            "November": ["Th√°ng n√†y ƒëang ngh·ªâ ng∆°i sau update."],
            "December": ["T√≥c m·ªõi & K·∫øt th√∫c m·ªôt nƒÉm r·ª±c r·ª°.\nMong l√† nƒÉm sau s·∫Ω c√≥ nhi·ªÅu h√¨nh h∆°n n·ªØa."]
        };

        const months = Object.keys(albumData);
        const book = document.getElementById('myBook');

        function isVideo(url) {
            return url.match(/\.(mp4|webm|ogg|mov)$/i) || url.includes('video');
        }

        function createGridHTML(monthName, dataArray, noteText = "") {
            if (!dataArray || dataArray.length === 0) {
                return `<h2 class="month-title">${monthName}</h2><div class="page-note">${noteText}</div>`;
            }
            return `
                <h2 class="month-title">${monthName}</h2>
                <div class="polaroid-grid">
                    ${dataArray.map((item, i) => {
                        const cap = item.caption || "2025 Memory";
                        const rotate = i % 2 === 0 ? '-2deg' : '2deg';
                        if (isVideo(item.url)) {
                            return `<div class="polaroid" style="--r: ${rotate}"><video src="${item.url}" muted loop autoplay playsinline></video><small>${cap}</small></div>`;
                        } else {
                            return `<div class="polaroid" style="--r: ${rotate}"><img src="${item.url}" loading="lazy"> <small>${cap}</small></div>`;
                        }
                    }).join('')}
                </div>
                <div class="page-note">${noteText}</div>`;
        }

        // Render Pages
        document.getElementById('jan-first-half').innerHTML = createGridHTML("January", albumData["January"].slice(0, 4), monthNotes["January"][0]);

        months.forEach((m, index) => {
            const p = document.createElement('div');
            p.className = 'page';
            p.style.zIndex = 50 - index;
            const note2 = (monthNotes[m] && monthNotes[m][1]) ? monthNotes[m][1] : "";
            const frontHTML = `<div class="front">${createGridHTML(m, albumData[m].slice(4, 8), note2)}</div>`;
            let backHTML = '<div class="back"></div>';
            if (index < months.length - 1) {
                const nextM = months[index+1];
                const note1 = (monthNotes[nextM] && monthNotes[nextM][0]) ? monthNotes[nextM][0] : "";
                backHTML = `<div class="back">${createGridHTML(nextM, albumData[nextM].slice(0, 4), note1)}</div>`;
            } else {
                backHTML = `<div class="back"><h2 class="month-title">Closing Words</h2><img src="https://i.postimg.cc/gJw31s3R/pic3.png" class="full-img">
                            <p class="desc">Th√™m m·ªôt nƒÉm g·∫Øn b√≥. D√π c√≥ l√∫c b·∫•t ƒë·ªìng nh∆∞ng tui mong t∆∞∆°ng lai m√¨nh v·∫´n s·∫Ω b·ªÅn l√¢u h∆°n n·ªØa.</p><span class="sticker">‚ù§Ô∏è</span></div>`;
            }
            p.innerHTML = frontHTML + backHTML;
            book.appendChild(p);
        });

        const summaryPage = document.createElement('div');
        summaryPage.className = 'page';
        summaryPage.style.zIndex = 10;
        summaryPage.innerHTML = `
            <div class="front" style="overflow-y: auto;">
                <h2 class="month-title">Share Little Moments</h2>
                <div class="voice-card"><p style="font-size:0.7rem; font-weight:bold;">üéß Tui c√≥ voice 1 ƒëo·∫°n ng·∫Øn, nghe th·ª≠ nha...</p>
                    <button id="btn-voice-play" class="btn-voice"><span>‚ñ∂</span> Nghe Voice</button>
                    <audio id="voice-message"><source src="./voice/voice.m4a" type="audio/mpeg"></audio>
                </div>
                <div class="video-card"><p style="font-size:0.7rem; font-weight:bold;">üé¨ Th∆∞·ªõc phim ng·∫Øn tui mu·ªën share</p>
                    <div class="video-container"><video width="100%" controls><source src="./video/thanks.mp4" type="video/mp4"></video></div>
                </div>
            </div>
            <div class="back">
                <h2 class="month-title">A Little Message</h2>
                <img src="https://i.postimg.cc/zvv8Jyn3/pic2_t12.png" class="full-img">
                <p class="desc">B·ªè qua m·ªçi mu·ªôn phi·ªÅn, chu·∫©n b·ªã cho nƒÉm m·ªõi r·ª±c r·ª°. Ch√∫c Trang lu√¥n may m·∫Øn, h·∫°nh ph√∫c v√† b√¨nh an!</p>
            </div>`;
        book.appendChild(summaryPage);

        const finalPage = document.createElement('div');
        finalPage.className = 'page';
        finalPage.style.zIndex = 5;
        finalPage.innerHTML = `
            <div class="front cover-front" style="padding: 20px;">
                <h2 style="font-family:'Dancing Script'; color:var(--accent-color); font-size: 1.8rem;">G·ª≠i 2026</h2>
                <textarea id="note-2026" placeholder="Vi·∫øt nh·ªØng ∆∞·ªõc nguy·ªán c·ªßa m·∫•y ng v√†o ƒë√¢y..."></textarea>
                <button id="btn-close" style="margin-top: 15px; padding: 12px; cursor: pointer; border: none; width: 100%; background: var(--accent-color); font-weight: bold;">T·∫†M BI·ªÜT 2025</button>
            </div>
            <div class="back cover-front"><h1>THE END</h1><p>2025</p></div>`;
        book.appendChild(finalPage);

        // ACTIONS
        const modal = document.getElementById('image-modal');
        const modalContainer = document.getElementById('modal-container');

        function initActions() {
            document.querySelectorAll('.page').forEach((page, index) => {
                const originalZ = parseInt(page.style.zIndex);
                page.addEventListener('click', function(e) {
                    if (isPinching) return;
                    if (['TEXTAREA', 'BUTTON', 'VIDEO', 'AUDIO', 'INPUT'].includes(e.target.tagName) || e.target.closest('.music-player')) return;
                    
                    if (e.target.tagName === 'IMG' || (e.target.tagName === 'VIDEO' && !e.target.hasAttribute('controls'))) {
                        modal.style.display = "flex";
                        modalContainer.innerHTML = e.target.tagName === 'VIDEO' ? 
                            `<video src="${e.target.src}" controls autoplay class="modal-content"></video>` : 
                            `<img src="${e.target.src}" class="modal-content">`;
                        return;
                    }

                    if (this.classList.contains('flipped')) {
                        this.classList.remove('flipped');
                        setTimeout(() => { this.style.zIndex = originalZ; }, 400); 
                    } else {
                        this.classList.add('flipped');
                        this.style.zIndex = 100 + index;
                    }
                });
            });
            modal.onclick = () => { modal.style.display = "none"; modalContainer.innerHTML = ""; };
        }
        setTimeout(initActions, 100);

        // ZOOM LOGIC
        const bookContainer = document.getElementById('book-container');
        const updateZoom = () => bookContainer.style.transform = `scale(${currentScale})`;

        document.getElementById('zoom-in').onclick = () => { if(currentScale < maxScale) { currentScale += 0.2; updateZoom(); } };
        document.getElementById('zoom-out').onclick = () => { if(currentScale > minScale) { currentScale -= 0.2; updateZoom(); } };
        document.getElementById('zoom-reset').onclick = () => { currentScale = window.innerWidth < 768 ? 0.8 : 1; updateZoom(); };

        // MOBILE PINCH ZOOM
        let initialDist = null;
        let startScale = currentScale;
        window.addEventListener('touchstart', e => {
            if (e.touches.length === 2) {
                isPinching = true;
                initialDist = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);
                startScale = currentScale;
            }
        }, {passive: false});

        window.addEventListener('touchmove', e => {
            if (e.touches.length === 2 && initialDist) {
                e.preventDefault();
                const dist = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);
                let newScale = startScale * (dist / initialDist);
                if (newScale >= minScale && newScale <= maxScale) { currentScale = newScale; updateZoom(); }
            }
        }, {passive: false});

        window.addEventListener('touchend', () => { setTimeout(() => isPinching = false, 200); initialDist = null; });

        // MUSIC
        const playlist = [
            { title: "Make It Right", src: "./music/Make_It_Right.mp3" },
            { title: "Love On Replay", src: "./music/Love_On_Replay.mp3" },
            { title: "golden hour", src: "./music/golden_hour.mp3" },
            { title: "No Reason", src: "./music/No_Reason.mp3" },
            { title: "Cho Em An To√†n", src: "./music/Cho_Em_An_Toan.mp3" }
        ];
        let songIdx = 0;
        const bgMusic = document.getElementById('bg-music');
        const playBtn = document.getElementById('play-pause');

        function loadSong(i) { bgMusic.src = playlist[i].src; document.getElementById('song-title').innerText = playlist[i].title; }
        const playSong = () => { bgMusic.play().catch(() => {}); playBtn.innerText = "‚è∏"; };

        playBtn.onclick = () => bgMusic.paused ? playSong() : (bgMusic.pause(), playBtn.innerText = "‚ñ∂");
        document.getElementById('next-song').onclick = () => { songIdx = (songIdx + 1) % playlist.length; loadSong(songIdx); playSong(); };
        document.getElementById('prev-song').onclick = () => { songIdx = (songIdx - 1 + playlist.length) % playlist.length; loadSong(songIdx); playSong(); };
        bgMusic.onended = () => document.getElementById('next-song').click();
        loadSong(0);

        // WELCOME & SNOW
        const welcomeText = "Hey\nM·ªôt nƒÉm n·ªØa l·∫°i tr√¥i qua\nTui c√≥ l√†m m·ªôt album nh·ªè v·ªÅ m·∫•y ng, m√¨nh c√πng xem nha\nMong l√† m·∫•y ng s·∫Ω th√≠ch n√≥";
        let charIdx = 0;
        function typeWriter() {
            if (charIdx < welcomeText.length) {
                document.getElementById("typewriter").innerHTML += welcomeText.charAt(charIdx) === '\n' ? '<br>' : welcomeText.charAt(charIdx);
                charIdx++; setTimeout(typeWriter, 50);
            } else { document.getElementById("btn-start").style.opacity = "1"; }
        }
        window.onload = typeWriter;

        document.getElementById('btn-start').onclick = () => {
            document.getElementById('welcome-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('welcome-screen').classList.add('hidden');
                document.getElementById('book-container').style.display = 'block';
                updateZoom(); playSong();
            }, 1000);
        };

        // Optimized Snow
        const snowCanvas = document.getElementById('snow-canvas');
        const sctx = snowCanvas.getContext('2d');
        let particles = [];
        const particleCount = window.innerWidth < 768 ? 30 : 70; // Gi·∫£m h·∫°t tr√™n mobile

        function resize() { snowCanvas.width = window.innerWidth; snowCanvas.height = window.innerHeight; }
        window.onresize = resize; resize();

        class Particle {
            constructor() { this.reset(); }
            reset() { this.x = Math.random() * snowCanvas.width; this.y = Math.random() * -snowCanvas.height; this.r = Math.random() * 3 + 1; this.s = Math.random() * 1 + 0.5; this.o = Math.random() * 0.5 + 0.3; }
            draw() {
                this.y += this.s; if (this.y > snowCanvas.height) this.reset();
                sctx.beginPath(); sctx.arc(this.x, this.y, this.r, 0, Math.PI * 2);
                sctx.fillStyle = `rgba(255,255,255,${this.o})`; sctx.fill();
            }
        }
        for(let i=0; i<particleCount; i++) particles.push(new Particle());
        function anim() { sctx.clearRect(0,0,snowCanvas.width, snowCanvas.height); particles.forEach(p => p.draw()); requestAnimationFrame(anim); }
        anim();

        // FIREWORKS
        document.getElementById('btn-close').onclick = () => {
            document.getElementById('myBook').style.transform = "scale(0)";
            document.getElementById('myBook').style.opacity = "0";
            setTimeout(() => {
                document.getElementById('book-container').style.display = "none";
                const fCanvas = document.getElementById('fireworks-canvas');
                const fctx = fCanvas.getContext('2d');
                fCanvas.style.display = "block";
                document.getElementById('happy-new-year-text').style.display = "block";
                setTimeout(() => document.getElementById('happy-new-year-text').classList.add('show'), 100);
                fCanvas.width = window.innerWidth; fCanvas.height = window.innerHeight;
                let fw = [];
                function animFW() {
                    fctx.fillStyle = 'rgba(15, 23, 42, 0.2)'; fctx.fillRect(0,0,fCanvas.width, fCanvas.height);
                    if (Math.random() < 0.1) {
                        let x = Math.random()*fCanvas.width, y = Math.random()*fCanvas.height*0.5, color = `hsl(${Math.random()*360},100%,50%)`;
                        for(let i=0; i<20; i++) fw.push({x, y, color, vx:(Math.random()-0.5)*8, vy:(Math.random()-0.5)*8, a:1});
                    }
                    fw.forEach((p, i) => {
                        p.x+=p.vx; p.y+=p.vy; p.a-=0.015;
                        if(p.a<=0) fw.splice(i,1);
                        else { fctx.globalAlpha=p.a; fctx.fillStyle=p.color; fctx.beginPath(); fctx.arc(p.x,p.y,2,0,Math.PI*2); fctx.fill(); }
                    });
                    requestAnimationFrame(animFW);
                }
                animFW();
            }, 800);
        };

        document.addEventListener('click', e => {
            if(e.target.id === 'btn-voice-play'){
                const v = document.getElementById('voice-message');
                v.paused ? (v.play(), e.target.innerHTML = "‚è∏ ƒêang Ph√°t") : (v.pause(), e.target.innerHTML = "‚ñ∂ Nghe Voice");
            }
        });
    </script>
</body>
</html>
